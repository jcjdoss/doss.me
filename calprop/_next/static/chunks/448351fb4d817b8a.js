(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,45003,e=>{"use strict";var t=e.i(59834),a=e.i(42650),r=e.i(42656),s=e.i(12061),n=e.i(17896),i=e.i(71908),l=e.i(22513),o=e.i(50875);function d({level:e,className:a}){let r=o.damageLevelColors[e.toLowerCase()]||"bg-muted text-muted-foreground border-muted";return(0,t.jsx)(i.Badge,{variant:"outline",className:(0,l.cn)("font-medium capitalize text-[11px] px-2 py-0.5",r,a),children:e.replace(/_/g," ")})}var c=e.i(36740),u=e.i(15357),m=e.i(25933),p=e.i(65597),x=e.i(44261);e.i(37673);var f=e.i(79542),h=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let s=(0,f.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?s:a,{...i,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),v=r.forwardRef((e,a)=>(0,t.jsx)(h.label,{...e,ref:a,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));v.displayName="Label",e.s(["Label",()=>v,"Root",()=>v],23469);var g=e.i(23469),g=g;function j({className:e,...a}){return(0,t.jsx)(g.Root,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}function y({className:e,...a}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}var b=e.i(79887),w=e.i(50752),N=e.i(2819),S=e.i(83113),C=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let s=(0,f.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?s:a,{...i,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),R=e.i(7101),D=e.i(87910),k=e.i(58853),P=e.i(63534),I=e.i(38798),A=e.i(81837),E="Radio",[M,T]=(0,S.createContextScope)(E),[L,z]=M(E),V=r.forwardRef((e,a)=>{let{__scopeRadio:s,name:n,checked:i=!1,required:l,disabled:o,value:d="on",onCheck:c,form:u,...m}=e,[p,x]=r.useState(null),f=(0,N.useComposedRefs)(a,e=>x(e)),h=r.useRef(!1),v=!p||u||!!p.closest("form");return(0,t.jsxs)(L,{scope:s,checked:i,disabled:o,children:[(0,t.jsx)(C.button,{type:"button",role:"radio","aria-checked":i,"data-state":K(i),"data-disabled":o?"":void 0,disabled:o,value:d,...m,ref:f,onClick:(0,w.composeEventHandlers)(e.onClick,e=>{i||c?.(),v&&(h.current=e.isPropagationStopped(),h.current||e.stopPropagation())})}),v&&(0,t.jsx)(_,{control:p,bubbles:!h.current,name:n,value:d,checked:i,required:l,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});V.displayName=E;var H="RadioIndicator",B=r.forwardRef((e,a)=>{let{__scopeRadio:r,forceMount:s,...n}=e,i=z(H,r);return(0,t.jsx)(A.Presence,{present:s||i.checked,children:(0,t.jsx)(C.span,{"data-state":K(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:a})})});B.displayName=H;var _=r.forwardRef(({__scopeRadio:e,control:a,checked:s,bubbles:n=!0,...i},l)=>{let o=r.useRef(null),d=(0,N.useComposedRefs)(o,l),c=(0,I.usePrevious)(s),u=(0,P.useSize)(a);return r.useEffect(()=>{let e=o.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==s&&t){let a=new Event("click",{bubbles:n});t.call(e,s),e.dispatchEvent(a)}},[c,s,n]),(0,t.jsx)(C.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...i,tabIndex:-1,ref:d,style:{...i.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function K(e){return e?"checked":"unchecked"}_.displayName="RadioBubbleInput";var O=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],$="RadioGroup",[F,G]=(0,S.createContextScope)($,[R.createRovingFocusGroupScope,T]),U=(0,R.createRovingFocusGroupScope)(),q=T(),[X,Y]=F($),J=r.forwardRef((e,a)=>{let{__scopeRadioGroup:r,name:s,defaultValue:n,value:i,required:l=!1,disabled:o=!1,orientation:d,dir:c,loop:u=!0,onValueChange:m,...p}=e,x=U(r),f=(0,k.useDirection)(c),[h,v]=(0,D.useControllableState)({prop:i,defaultProp:n??null,onChange:m,caller:$});return(0,t.jsx)(X,{scope:r,name:s,required:l,disabled:o,value:h,onValueChange:v,children:(0,t.jsx)(R.Root,{asChild:!0,...x,orientation:d,dir:f,loop:u,children:(0,t.jsx)(C.div,{role:"radiogroup","aria-required":l,"aria-orientation":d,"data-disabled":o?"":void 0,dir:f,...p,ref:a})})})});J.displayName=$;var Q="RadioGroupItem",W=r.forwardRef((e,a)=>{let{__scopeRadioGroup:s,disabled:n,...i}=e,l=Y(Q,s),o=l.disabled||n,d=U(s),c=q(s),u=r.useRef(null),m=(0,N.useComposedRefs)(a,u),p=l.value===i.value,x=r.useRef(!1);return r.useEffect(()=>{let e=e=>{O.includes(e.key)&&(x.current=!0)},t=()=>x.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,t.jsx)(R.Item,{asChild:!0,...d,focusable:!o,active:p,children:(0,t.jsx)(V,{disabled:o,required:l.required,checked:p,...c,...i,name:l.name,ref:m,onCheck:()=>l.onValueChange(i.value),onKeyDown:(0,w.composeEventHandlers)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,w.composeEventHandlers)(i.onFocus,()=>{x.current&&u.current?.click()})})})});W.displayName=Q;var Z=r.forwardRef((e,a)=>{let{__scopeRadioGroup:r,...s}=e,n=q(r);return(0,t.jsx)(B,{...n,...s,ref:a})});Z.displayName="RadioGroupIndicator",e.s(["Indicator",()=>Z,"Item",()=>W,"RadioGroup",()=>J,"RadioGroupIndicator",()=>Z,"RadioGroupItem",()=>W,"Root",()=>J,"createRadioGroupScope",()=>G],69525);var ee=e.i(69525),ee=ee;function et({className:e,...a}){return(0,t.jsx)(ee.Root,{"data-slot":"radio-group",className:(0,l.cn)("grid gap-3",e),...a})}function ea({className:e,...a}){return(0,t.jsx)(ee.Item,{"data-slot":"radio-group-item",className:(0,l.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...a,children:(0,t.jsx)(ee.Indicator,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,t.jsx)(b.CircleIcon,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var er=e.i(71579),es=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let s=(0,f.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?s:a,{...i,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),en=e.i(31254),ei=["PageUp","PageDown"],el=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],eo={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ed="Slider",[ec,eu,em]=(0,en.createCollection)(ed),[ep,ex]=(0,S.createContextScope)(ed,[em]),[ef,eh]=ep(ed),ev=r.forwardRef((e,a)=>{let{name:s,min:n=0,max:i=100,step:l=1,orientation:o="horizontal",disabled:d=!1,minStepsBetweenThumbs:c=0,defaultValue:u=[n],value:m,onValueChange:p=()=>{},onValueCommit:x=()=>{},inverted:f=!1,form:h,...v}=e,g=r.useRef(new Set),j=r.useRef(0),y="horizontal"===o,[b=[],N]=(0,D.useControllableState)({prop:m,defaultProp:u,onChange:e=>{let t=[...g.current];t[j.current]?.focus(),p(e)}}),S=r.useRef(b);function C(e,t,{commit:a}={commit:!1}){let r,s=(String(l).split(".")[1]||"").length,o=Math.round((Math.round((e-n)/l)*l+n)*(r=Math.pow(10,s)))/r,d=(0,er.clamp)(o,[n,i]);N((e=[])=>{let r=function(e=[],t,a){let r=[...e];return r[a]=t,r.sort((e,t)=>e-t)}(e,d,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,a)=>e[a+1]-t))>=t;return!0}(r,c*l))return e;{j.current=r.indexOf(d);let t=String(r)!==String(e);return t&&a&&x(r),t?r:e}})}return(0,t.jsx)(ef,{scope:e.__scopeSlider,name:s,disabled:d,min:n,max:i,valueIndexToChangeRef:j,thumbs:g.current,values:b,orientation:o,form:h,children:(0,t.jsx)(ec.Provider,{scope:e.__scopeSlider,children:(0,t.jsx)(ec.Slot,{scope:e.__scopeSlider,children:(0,t.jsx)(y?ey:eb,{"aria-disabled":d,"data-disabled":d?"":void 0,...v,ref:a,onPointerDown:(0,w.composeEventHandlers)(v.onPointerDown,()=>{d||(S.current=b)}),min:n,max:i,inverted:f,onSlideStart:d?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let a=e.map(e=>Math.abs(e-t)),r=Math.min(...a);return a.indexOf(r)}(b,e);C(e,t)},onSlideMove:d?void 0:function(e){C(e,j.current)},onSlideEnd:d?void 0:function(){let e=S.current[j.current];b[j.current]!==e&&x(b)},onHomeKeyDown:()=>!d&&C(n,0,{commit:!0}),onEndKeyDown:()=>!d&&C(i,b.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!d){let a=ei.includes(e.key)||e.shiftKey&&el.includes(e.key),r=j.current;C(b[r]+l*(a?10:1)*t,r,{commit:!0})}}})})})})});ev.displayName=ed;var[eg,ej]=ep(ed,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ey=r.forwardRef((e,a)=>{let{min:s,max:n,dir:i,inverted:l,onSlideStart:o,onSlideMove:d,onSlideEnd:c,onStepKeyDown:u,...m}=e,[p,x]=r.useState(null),f=(0,N.useComposedRefs)(a,e=>x(e)),h=r.useRef(void 0),v=(0,k.useDirection)(i),g="ltr"===v,j=g&&!l||!g&&l;function y(e){let t=h.current||p.getBoundingClientRect(),a=eE([0,t.width],j?[s,n]:[n,s]);return h.current=t,a(e-t.left)}return(0,t.jsx)(eg,{scope:e.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width",children:(0,t.jsx)(ew,{dir:v,"data-orientation":"horizontal",...m,ref:f,style:{...m.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=y(e.clientX);o?.(t)},onSlideMove:e=>{let t=y(e.clientX);d?.(t)},onSlideEnd:()=>{h.current=void 0,c?.()},onStepKeyDown:e=>{let t=eo[j?"from-left":"from-right"].includes(e.key);u?.({event:e,direction:t?-1:1})}})})}),eb=r.forwardRef((e,a)=>{let{min:s,max:n,inverted:i,onSlideStart:l,onSlideMove:o,onSlideEnd:d,onStepKeyDown:c,...u}=e,m=r.useRef(null),p=(0,N.useComposedRefs)(a,m),x=r.useRef(void 0),f=!i;function h(e){let t=x.current||m.current.getBoundingClientRect(),a=eE([0,t.height],f?[n,s]:[s,n]);return x.current=t,a(e-t.top)}return(0,t.jsx)(eg,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:(0,t.jsx)(ew,{"data-orientation":"vertical",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=h(e.clientY);l?.(t)},onSlideMove:e=>{let t=h(e.clientY);o?.(t)},onSlideEnd:()=>{x.current=void 0,d?.()},onStepKeyDown:e=>{let t=eo[f?"from-bottom":"from-top"].includes(e.key);c?.({event:e,direction:t?-1:1})}})})}),ew=r.forwardRef((e,a)=>{let{__scopeSlider:r,onSlideStart:s,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:d,...c}=e,u=eh(ed,r);return(0,t.jsx)(es.span,{...c,ref:a,onKeyDown:(0,w.composeEventHandlers)(e.onKeyDown,e=>{"Home"===e.key?(l(e),e.preventDefault()):"End"===e.key?(o(e),e.preventDefault()):ei.concat(el).includes(e.key)&&(d(e),e.preventDefault())}),onPointerDown:(0,w.composeEventHandlers)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),u.thumbs.has(t)?t.focus():s(e)}),onPointerMove:(0,w.composeEventHandlers)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&n(e)}),onPointerUp:(0,w.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),eN="SliderTrack",eS=r.forwardRef((e,a)=>{let{__scopeSlider:r,...s}=e,n=eh(eN,r);return(0,t.jsx)(es.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...s,ref:a})});eS.displayName=eN;var eC="SliderRange",eR=r.forwardRef((e,a)=>{let{__scopeSlider:s,...n}=e,i=eh(eC,s),l=ej(eC,s),o=r.useRef(null),d=(0,N.useComposedRefs)(a,o),c=i.values.length,u=i.values.map(e=>eA(e,i.min,i.max)),m=c>1?Math.min(...u):0,p=100-Math.max(...u);return(0,t.jsx)(es.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...n,ref:d,style:{...e.style,[l.startEdge]:m+"%",[l.endEdge]:p+"%"}})});eR.displayName=eC;var eD="SliderThumb",ek=r.forwardRef((e,a)=>{let s=eu(e.__scopeSlider),[n,i]=r.useState(null),l=(0,N.useComposedRefs)(a,e=>i(e)),o=r.useMemo(()=>n?s().findIndex(e=>e.ref.current===n):-1,[s,n]);return(0,t.jsx)(eP,{...e,ref:l,index:o})}),eP=r.forwardRef((e,a)=>{var s,n,i,l,o;let d,c,{__scopeSlider:u,index:m,name:p,...x}=e,f=eh(eD,u),h=ej(eD,u),[v,g]=r.useState(null),j=(0,N.useComposedRefs)(a,e=>g(e)),y=!v||f.form||!!v.closest("form"),b=(0,P.useSize)(v),S=f.values[m],C=void 0===S?0:eA(S,f.min,f.max),R=(s=m,(n=f.values.length)>2?`Value ${s+1} of ${n}`:2===n?["Minimum","Maximum"][s]:void 0),D=b?.[h.size],k=D?(i=D,l=C,o=h.direction,c=eE([0,50],[0,d=i/2]),(d-c(l)*o)*o):0;return r.useEffect(()=>{if(v)return f.thumbs.add(v),()=>{f.thumbs.delete(v)}},[v,f.thumbs]),(0,t.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[h.startEdge]:`calc(${C}% + ${k}px)`},children:[(0,t.jsx)(ec.ItemSlot,{scope:e.__scopeSlider,children:(0,t.jsx)(es.span,{role:"slider","aria-label":e["aria-label"]||R,"aria-valuemin":f.min,"aria-valuenow":S,"aria-valuemax":f.max,"aria-orientation":f.orientation,"data-orientation":f.orientation,"data-disabled":f.disabled?"":void 0,tabIndex:f.disabled?void 0:0,...x,ref:j,style:void 0===S?{display:"none"}:e.style,onFocus:(0,w.composeEventHandlers)(e.onFocus,()=>{f.valueIndexToChangeRef.current=m})})}),y&&(0,t.jsx)(eI,{name:p??(f.name?f.name+(f.values.length>1?"[]":""):void 0),form:f.form,value:S},m)]})});ek.displayName=eD;var eI=r.forwardRef(({__scopeSlider:e,value:a,...s},n)=>{let i=r.useRef(null),l=(0,N.useComposedRefs)(i,n),o=(0,I.usePrevious)(a);return r.useEffect(()=>{let e=i.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(o!==a&&t){let r=new Event("input",{bubbles:!0});t.call(e,a),e.dispatchEvent(r)}},[o,a]),(0,t.jsx)(es.input,{style:{display:"none"},...s,ref:l,defaultValue:a})});function eA(e,t,a){return(0,er.clamp)(100/(a-t)*(e-t),[0,100])}function eE(e,t){return a=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(a-e[0])}}eI.displayName="RadioBubbleInput",e.s(["Range",()=>eR,"Root",()=>ev,"Slider",()=>ev,"SliderRange",()=>eR,"SliderThumb",()=>ek,"SliderTrack",()=>eS,"Thumb",()=>ek,"Track",()=>eS,"createSliderScope",()=>ex],86976);var eM=e.i(86976),eM=eM;function eT({className:e,defaultValue:a,value:s,min:n=0,max:i=100,...o}){let d=r.useMemo(()=>Array.isArray(s)?s:Array.isArray(a)?a:[n,i],[s,a,n,i]);return(0,t.jsxs)(eM.Root,{"data-slot":"slider",defaultValue:a,value:s,min:n,max:i,className:(0,l.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...o,children:[(0,t.jsx)(eM.Track,{"data-slot":"slider-track",className:(0,l.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,t.jsx)(eM.Range,{"data-slot":"slider-range",className:(0,l.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(e,a)=>(0,t.jsx)(eM.Thumb,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},a))]})}var eL=e.i(41868),ez=e.i(69501),eV=e.i(94325);let eH=(0,eV.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),eB=[{value:"destroyed",label:"Destroyed",description:"Structure completely destroyed"},{value:"major",label:"Major",description:"Significant structural damage"},{value:"minor",label:"Minor",description:"Cosmetic or limited damage"},{value:"affected",label:"Affected",description:"In affected area, minor impact"},{value:"none",label:"None",description:"No damage observed"}];function e_({open:e,onOpenChange:a,incidentId:n,parcel:i}){let[l,o]=(0,r.useState)("minor"),[d,c]=(0,r.useState)([25]),[u,m]=(0,r.useState)([10]),[f,h]=(0,r.useState)(new Date().toISOString().split("T")[0]),[v,g]=(0,r.useState)(""),b=(0,s.useSubmitSurvey)(),w=async()=>{try{await b.mutateAsync({incidentId:n,parcelId:i.affectedParcelId,survey:{damageLevel:l,improvementDamagePercent:d[0],landDamagePercent:u[0],surveyDate:f,notes:v}}),ez.toast.success("Damage survey submitted",{description:`Survey recorded for parcel ${i.apn}`}),a(!1)}catch(e){ez.toast.error("Failed to submit survey",{description:"Please try again"})}};return(0,t.jsx)(p.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(p.DialogContent,{className:"sm:max-w-lg",children:[(0,t.jsxs)(p.DialogHeader,{children:[(0,t.jsx)(p.DialogTitle,{children:"Damage Survey"}),(0,t.jsxs)(p.DialogDescription,{children:["Record damage assessment for parcel"," ",(0,t.jsx)("span",{className:"font-mono font-medium",children:i.apn})]})]}),(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(j,{className:"text-sm font-medium",children:"Damage Level"}),(0,t.jsx)(et,{value:l,onValueChange:o,children:eB.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 rounded-lg border p-3 cursor-pointer hover:bg-muted/50 transition-colors",children:[(0,t.jsx)(ea,{value:e.value,id:e.value}),(0,t.jsxs)(j,{htmlFor:e.value,className:"flex-1 cursor-pointer",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.label}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.value))})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(j,{className:"text-sm font-medium",children:"Improvement Damage"}),(0,t.jsxs)("span",{className:"text-sm font-medium tabular-nums",children:[d[0],"%"]})]}),(0,t.jsx)(eT,{value:d,onValueChange:c,min:0,max:100,step:5,className:"w-full"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(j,{className:"text-sm font-medium",children:"Land Damage"}),(0,t.jsxs)("span",{className:"text-sm font-medium tabular-nums",children:[u[0],"%"]})]}),(0,t.jsx)(eT,{value:u,onValueChange:m,min:0,max:100,step:5,className:"w-full"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j,{className:"text-sm font-medium",children:"Survey Date"}),(0,t.jsx)(eL.Input,{type:"date",value:f,onChange:e=>h(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j,{className:"text-sm font-medium",children:"Notes"}),(0,t.jsx)(y,{value:v,onChange:e=>g(e.target.value),placeholder:"Additional observations...",rows:3})]})]}),(0,t.jsxs)(p.DialogFooter,{children:[(0,t.jsx)(x.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,t.jsxs)(x.Button,{onClick:w,disabled:b.isPending,children:[b.isPending&&(0,t.jsx)(eH,{className:"h-4 w-4 mr-2 animate-spin"}),"Submit Survey"]})]})]})})}var eK=e.i(48846);let eO=(0,eV.default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);var e$=e.i(36941);function eF({open:e,onOpenChange:a,incidentId:n,parcel:i}){let[l,o]=(0,r.useState)(null),d=(0,s.useComputeReassessment)(),c=async()=>{try{let e=await d.mutateAsync({incidentId:n,parcelId:i.affectedParcelId});o(e),ez.toast.success("Reassessment computed",{description:`Value reduction of ${(0,eK.formatCurrency)(e.reductionAmount)} for parcel ${i.apn}`})}catch(e){ez.toast.error("Failed to compute reassessment",{description:"Please try again"})}};return(0,t.jsx)(p.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(p.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(p.DialogHeader,{children:[(0,t.jsx)(p.DialogTitle,{children:"Reassessment"}),(0,t.jsxs)(p.DialogDescription,{children:["Compute revised values for parcel"," ",(0,t.jsx)("span",{className:"font-mono font-medium",children:i.apn})]})]}),l?(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-success",children:[(0,t.jsx)(e$.CheckCircle,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Reassessment Complete"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Prior Value"}),(0,t.jsx)("p",{className:"text-sm font-semibold tabular-nums",children:(0,eK.formatCurrency)(l.priorTotalValue)})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Revised Value"}),(0,t.jsx)("p",{className:"text-sm font-semibold tabular-nums text-primary",children:(0,eK.formatCurrency)(l.revisedTotalValue)})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Reduction"}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,t.jsx)(eO,{className:"h-3.5 w-3.5 text-destructive"}),(0,t.jsx)("p",{className:"text-sm font-semibold tabular-nums text-destructive",children:(0,eK.formatCurrency)(l.reductionAmount)})]})]})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-3 space-y-2 text-xs",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Land"}),(0,t.jsxs)("span",{children:[(0,eK.formatCurrency)(l.priorLandValue)," → ",(0,eK.formatCurrency)(l.revisedLandValue)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Improvements"}),(0,t.jsxs)("span",{children:[(0,eK.formatCurrency)(l.priorImprovementValue)," → ",(0,eK.formatCurrency)(l.revisedImprovementValue)]})]})]})]}):(0,t.jsx)("div",{className:"py-6 text-center",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"This will compute revised property values based on the recorded damage survey data. The computation uses standard calamity reassessment formulas."})}),(0,t.jsx)(p.DialogFooter,{children:l?(0,t.jsx)(x.Button,{onClick:()=>a(!1),children:"Done"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,t.jsxs)(x.Button,{onClick:c,disabled:d.isPending,children:[d.isPending&&(0,t.jsx)(eH,{className:"h-4 w-4 mr-2 animate-spin"}),"Compute Reassessment"]})]})})]})})}var eG=e.i(31906),eU=e.i(93749),eq=e.i(79001),eX=e.i(31404),eY=e.i(43970),eJ=e.i(83685),eQ=e.i(75482);let eW=(0,eV.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var eZ=e.i(69833);let e0=(0,eV.default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var e1=e.i(33217);function e2(){let e=(0,a.useParams)().id,{data:l,isLoading:p,error:f}=(0,s.useIncident)(e),[h,v]=(0,r.useState)(1),[g,j]=(0,r.useState)("all"),[y,b]=(0,r.useState)(null),[w,N]=(0,r.useState)(null),{data:S,isLoading:C}=(0,s.useAffectedParcels)({incidentId:e,page:h,damageLevel:"all"!==g?g:void 0});if(p)return(0,t.jsx)(eU.DetailSkeleton,{});if(f||!l)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(eJ.AlertCircle,{className:"h-8 w-8 text-destructive mb-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Incident not found"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"The requested incident could not be loaded."})]});let R=[{accessorKey:"apn",header:"APN",cell:({row:e})=>(0,t.jsx)(e1.default,{href:`/parcels/${e.original.parcelId}`,className:"font-mono text-sm font-medium text-primary hover:underline",children:e.getValue("apn")})},{accessorKey:"primaryAddress",header:"Address",cell:({row:e})=>(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e.getValue("primaryAddress")||"—"})},{accessorKey:"damageLevel",header:"Damage",cell:({row:e})=>{let a=e.getValue("damageLevel");return a?(0,t.jsx)(d,{level:a}):(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"—"})}},{accessorKey:"surveyStatus",header:"Survey",cell:({row:e})=>(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs capitalize",children:e.getValue("surveyStatus")?.replace(/_/g," ")||"pending"})},{accessorKey:"reassessmentStatus",header:"Reassessment",cell:({row:e})=>(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs capitalize",children:e.getValue("reassessmentStatus")?.replace(/_/g," ")||"pending"})},{id:"actions",header:"Actions",cell:({row:e})=>{let a=e.original;return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)(x.Button,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:e=>{e.stopPropagation(),b(a)},children:[(0,t.jsx)(eZ.FileSearch,{className:"h-3.5 w-3.5 mr-1"}),"Survey"]}),(0,t.jsxs)(x.Button,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:e=>{e.stopPropagation(),N(a)},children:[(0,t.jsx)(e0,{className:"h-3.5 w-3.5 mr-1"}),"Reassess"]})]})}}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(e1.default,{href:"/calamity",children:(0,t.jsxs)(x.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground -ml-2",children:[(0,t.jsx)(eY.ArrowLeft,{className:"h-4 w-4 mr-1"}),"Calamity"]})}),(0,t.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(m.IncidentTypeIcon,{type:l.incidentType,size:"lg"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:l.name}),(0,t.jsx)(n.StatusBadge,{status:l.status})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:o.incidentTypeLabels[l.incidentType]||l.incidentType})]})]})}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsx)(eq.Card,{className:"shadow-sm",children:(0,t.jsxs)(eq.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)(eW,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start Date"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:(0,eK.formatDate)(l.startDate)})]})]})}),(0,t.jsx)(eq.Card,{className:"shadow-sm",children:(0,t.jsxs)(eq.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)(eW,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"End Date"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:l.endDate?(0,eK.formatDate)(l.endDate):"Ongoing"})]})]})}),(0,t.jsx)(eq.Card,{className:"shadow-sm",children:(0,t.jsxs)(eq.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)(eQ.MapPin,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Affected Parcels"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:l.affectedParcelCount||0})]})]})})]}),l.description&&(0,t.jsx)(eq.Card,{className:"shadow-sm",children:(0,t.jsx)(eq.CardContent,{className:"p-4",children:(0,t.jsx)("p",{className:"text-sm",children:l.description})})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Affected Parcels"}),(0,t.jsxs)(eX.Select,{value:g,onValueChange:e=>{j(e),v(1)},children:[(0,t.jsx)(eX.SelectTrigger,{className:"h-9 w-[160px]",children:(0,t.jsx)(eX.SelectValue,{placeholder:"Damage Level"})}),(0,t.jsxs)(eX.SelectContent,{children:[(0,t.jsx)(eX.SelectItem,{value:"all",children:"All Levels"}),(0,t.jsx)(eX.SelectItem,{value:"destroyed",children:"Destroyed"}),(0,t.jsx)(eX.SelectItem,{value:"major",children:"Major"}),(0,t.jsx)(eX.SelectItem,{value:"minor",children:"Minor"}),(0,t.jsx)(eX.SelectItem,{value:"affected",children:"Affected"}),(0,t.jsx)(eX.SelectItem,{value:"none",children:"None"})]})]})]}),(0,t.jsx)(c.DataTable,{columns:R,data:S?.data||[],isLoading:C,emptyState:(0,t.jsx)(eG.EmptyState,{icon:eQ.MapPin,title:"No affected parcels",description:"No parcels have been linked to this incident yet."})}),S?.pagination&&(0,t.jsx)(u.DataTablePagination,{pagination:S.pagination,onPageChange:v})]}),y&&(0,t.jsx)(e_,{open:!!y,onOpenChange:e=>!e&&b(null),incidentId:e,parcel:y}),w&&(0,t.jsx)(eF,{open:!!w,onOpenChange:e=>!e&&N(null),incidentId:e,parcel:w})]})}e.s(["default",()=>e2],45003)}]);