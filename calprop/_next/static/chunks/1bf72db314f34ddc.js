(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,45003,e=>{"use strict";var t=e.i(59834),a=e.i(42650),r=e.i(42656),s=e.i(12061),n=e.i(17896),i=e.i(52815),l=e.i(36740),o=e.i(15357),d=e.i(25933),c=e.i(65597),u=e.i(44261);e.i(37673);var m=e.i(79542),p=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let s=(0,m.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?s:a,{...i,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),x=r.forwardRef((e,a)=>(0,t.jsx)(p.label,{...e,ref:a,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));x.displayName="Label",e.s(["Label",()=>x,"Root",()=>x],23469);var f=e.i(23469),f=f,h=e.i(22513);function v({className:e,...a}){return(0,t.jsx)(f.Root,{"data-slot":"label",className:(0,h.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}function g({className:e,...a}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,h.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}var j=e.i(79887),y=e.i(50752),b=e.i(2819),w=e.i(83113),N=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let s=(0,m.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?s:a,{...i,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),S=e.i(7101),C=e.i(87910),R=e.i(58853),D=e.i(63534),P=e.i(38798),k=e.i(81837),I="Radio",[A,E]=(0,w.createContextScope)(I),[T,M]=A(I),L=r.forwardRef((e,a)=>{let{__scopeRadio:s,name:n,checked:i=!1,required:l,disabled:o,value:d="on",onCheck:c,form:u,...m}=e,[p,x]=r.useState(null),f=(0,b.useComposedRefs)(a,e=>x(e)),h=r.useRef(!1),v=!p||u||!!p.closest("form");return(0,t.jsxs)(T,{scope:s,checked:i,disabled:o,children:[(0,t.jsx)(N.button,{type:"button",role:"radio","aria-checked":i,"data-state":B(i),"data-disabled":o?"":void 0,disabled:o,value:d,...m,ref:f,onClick:(0,y.composeEventHandlers)(e.onClick,e=>{i||c?.(),v&&(h.current=e.isPropagationStopped(),h.current||e.stopPropagation())})}),v&&(0,t.jsx)(H,{control:p,bubbles:!h.current,name:n,value:d,checked:i,required:l,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});L.displayName=I;var V="RadioIndicator",z=r.forwardRef((e,a)=>{let{__scopeRadio:r,forceMount:s,...n}=e,i=M(V,r);return(0,t.jsx)(k.Presence,{present:s||i.checked,children:(0,t.jsx)(N.span,{"data-state":B(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:a})})});z.displayName=V;var H=r.forwardRef(({__scopeRadio:e,control:a,checked:s,bubbles:n=!0,...i},l)=>{let o=r.useRef(null),d=(0,b.useComposedRefs)(o,l),c=(0,P.usePrevious)(s),u=(0,D.useSize)(a);return r.useEffect(()=>{let e=o.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==s&&t){let a=new Event("click",{bubbles:n});t.call(e,s),e.dispatchEvent(a)}},[c,s,n]),(0,t.jsx)(N.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...i,tabIndex:-1,ref:d,style:{...i.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function B(e){return e?"checked":"unchecked"}H.displayName="RadioBubbleInput";var K=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],_="RadioGroup",[O,$]=(0,w.createContextScope)(_,[S.createRovingFocusGroupScope,E]),F=(0,S.createRovingFocusGroupScope)(),G=E(),[U,q]=O(_),X=r.forwardRef((e,a)=>{let{__scopeRadioGroup:r,name:s,defaultValue:n,value:i,required:l=!1,disabled:o=!1,orientation:d,dir:c,loop:u=!0,onValueChange:m,...p}=e,x=F(r),f=(0,R.useDirection)(c),[h,v]=(0,C.useControllableState)({prop:i,defaultProp:n??null,onChange:m,caller:_});return(0,t.jsx)(U,{scope:r,name:s,required:l,disabled:o,value:h,onValueChange:v,children:(0,t.jsx)(S.Root,{asChild:!0,...x,orientation:d,dir:f,loop:u,children:(0,t.jsx)(N.div,{role:"radiogroup","aria-required":l,"aria-orientation":d,"data-disabled":o?"":void 0,dir:f,...p,ref:a})})})});X.displayName=_;var Y="RadioGroupItem",J=r.forwardRef((e,a)=>{let{__scopeRadioGroup:s,disabled:n,...i}=e,l=q(Y,s),o=l.disabled||n,d=F(s),c=G(s),u=r.useRef(null),m=(0,b.useComposedRefs)(a,u),p=l.value===i.value,x=r.useRef(!1);return r.useEffect(()=>{let e=e=>{K.includes(e.key)&&(x.current=!0)},t=()=>x.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,t.jsx)(S.Item,{asChild:!0,...d,focusable:!o,active:p,children:(0,t.jsx)(L,{disabled:o,required:l.required,checked:p,...c,...i,name:l.name,ref:m,onCheck:()=>l.onValueChange(i.value),onKeyDown:(0,y.composeEventHandlers)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,y.composeEventHandlers)(i.onFocus,()=>{x.current&&u.current?.click()})})})});J.displayName=Y;var Q=r.forwardRef((e,a)=>{let{__scopeRadioGroup:r,...s}=e,n=G(r);return(0,t.jsx)(z,{...n,...s,ref:a})});Q.displayName="RadioGroupIndicator",e.s(["Indicator",()=>Q,"Item",()=>J,"RadioGroup",()=>X,"RadioGroupIndicator",()=>Q,"RadioGroupItem",()=>J,"Root",()=>X,"createRadioGroupScope",()=>$],69525);var W=e.i(69525),W=W;function Z({className:e,...a}){return(0,t.jsx)(W.Root,{"data-slot":"radio-group",className:(0,h.cn)("grid gap-3",e),...a})}function ee({className:e,...a}){return(0,t.jsx)(W.Item,{"data-slot":"radio-group-item",className:(0,h.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...a,children:(0,t.jsx)(W.Indicator,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,t.jsx)(j.CircleIcon,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var et=e.i(71579),ea=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let s=(0,m.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?s:a,{...i,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),er=e.i(31254),es=["PageUp","PageDown"],en=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ei={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},el="Slider",[eo,ed,ec]=(0,er.createCollection)(el),[eu,em]=(0,w.createContextScope)(el,[ec]),[ep,ex]=eu(el),ef=r.forwardRef((e,a)=>{let{name:s,min:n=0,max:i=100,step:l=1,orientation:o="horizontal",disabled:d=!1,minStepsBetweenThumbs:c=0,defaultValue:u=[n],value:m,onValueChange:p=()=>{},onValueCommit:x=()=>{},inverted:f=!1,form:h,...v}=e,g=r.useRef(new Set),j=r.useRef(0),b="horizontal"===o,[w=[],N]=(0,C.useControllableState)({prop:m,defaultProp:u,onChange:e=>{let t=[...g.current];t[j.current]?.focus(),p(e)}}),S=r.useRef(w);function R(e,t,{commit:a}={commit:!1}){let r,s=(String(l).split(".")[1]||"").length,o=Math.round((Math.round((e-n)/l)*l+n)*(r=Math.pow(10,s)))/r,d=(0,et.clamp)(o,[n,i]);N((e=[])=>{let r=function(e=[],t,a){let r=[...e];return r[a]=t,r.sort((e,t)=>e-t)}(e,d,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,a)=>e[a+1]-t))>=t;return!0}(r,c*l))return e;{j.current=r.indexOf(d);let t=String(r)!==String(e);return t&&a&&x(r),t?r:e}})}return(0,t.jsx)(ep,{scope:e.__scopeSlider,name:s,disabled:d,min:n,max:i,valueIndexToChangeRef:j,thumbs:g.current,values:w,orientation:o,form:h,children:(0,t.jsx)(eo.Provider,{scope:e.__scopeSlider,children:(0,t.jsx)(eo.Slot,{scope:e.__scopeSlider,children:(0,t.jsx)(b?eg:ej,{"aria-disabled":d,"data-disabled":d?"":void 0,...v,ref:a,onPointerDown:(0,y.composeEventHandlers)(v.onPointerDown,()=>{d||(S.current=w)}),min:n,max:i,inverted:f,onSlideStart:d?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let a=e.map(e=>Math.abs(e-t)),r=Math.min(...a);return a.indexOf(r)}(w,e);R(e,t)},onSlideMove:d?void 0:function(e){R(e,j.current)},onSlideEnd:d?void 0:function(){let e=S.current[j.current];w[j.current]!==e&&x(w)},onHomeKeyDown:()=>!d&&R(n,0,{commit:!0}),onEndKeyDown:()=>!d&&R(i,w.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!d){let a=es.includes(e.key)||e.shiftKey&&en.includes(e.key),r=j.current;R(w[r]+l*(a?10:1)*t,r,{commit:!0})}}})})})})});ef.displayName=el;var[eh,ev]=eu(el,{startEdge:"left",endEdge:"right",size:"width",direction:1}),eg=r.forwardRef((e,a)=>{let{min:s,max:n,dir:i,inverted:l,onSlideStart:o,onSlideMove:d,onSlideEnd:c,onStepKeyDown:u,...m}=e,[p,x]=r.useState(null),f=(0,b.useComposedRefs)(a,e=>x(e)),h=r.useRef(void 0),v=(0,R.useDirection)(i),g="ltr"===v,j=g&&!l||!g&&l;function y(e){let t=h.current||p.getBoundingClientRect(),a=eI([0,t.width],j?[s,n]:[n,s]);return h.current=t,a(e-t.left)}return(0,t.jsx)(eh,{scope:e.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width",children:(0,t.jsx)(ey,{dir:v,"data-orientation":"horizontal",...m,ref:f,style:{...m.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=y(e.clientX);o?.(t)},onSlideMove:e=>{let t=y(e.clientX);d?.(t)},onSlideEnd:()=>{h.current=void 0,c?.()},onStepKeyDown:e=>{let t=ei[j?"from-left":"from-right"].includes(e.key);u?.({event:e,direction:t?-1:1})}})})}),ej=r.forwardRef((e,a)=>{let{min:s,max:n,inverted:i,onSlideStart:l,onSlideMove:o,onSlideEnd:d,onStepKeyDown:c,...u}=e,m=r.useRef(null),p=(0,b.useComposedRefs)(a,m),x=r.useRef(void 0),f=!i;function h(e){let t=x.current||m.current.getBoundingClientRect(),a=eI([0,t.height],f?[n,s]:[s,n]);return x.current=t,a(e-t.top)}return(0,t.jsx)(eh,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:(0,t.jsx)(ey,{"data-orientation":"vertical",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=h(e.clientY);l?.(t)},onSlideMove:e=>{let t=h(e.clientY);o?.(t)},onSlideEnd:()=>{x.current=void 0,d?.()},onStepKeyDown:e=>{let t=ei[f?"from-bottom":"from-top"].includes(e.key);c?.({event:e,direction:t?-1:1})}})})}),ey=r.forwardRef((e,a)=>{let{__scopeSlider:r,onSlideStart:s,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:d,...c}=e,u=ex(el,r);return(0,t.jsx)(ea.span,{...c,ref:a,onKeyDown:(0,y.composeEventHandlers)(e.onKeyDown,e=>{"Home"===e.key?(l(e),e.preventDefault()):"End"===e.key?(o(e),e.preventDefault()):es.concat(en).includes(e.key)&&(d(e),e.preventDefault())}),onPointerDown:(0,y.composeEventHandlers)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),u.thumbs.has(t)?t.focus():s(e)}),onPointerMove:(0,y.composeEventHandlers)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&n(e)}),onPointerUp:(0,y.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),eb="SliderTrack",ew=r.forwardRef((e,a)=>{let{__scopeSlider:r,...s}=e,n=ex(eb,r);return(0,t.jsx)(ea.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...s,ref:a})});ew.displayName=eb;var eN="SliderRange",eS=r.forwardRef((e,a)=>{let{__scopeSlider:s,...n}=e,i=ex(eN,s),l=ev(eN,s),o=r.useRef(null),d=(0,b.useComposedRefs)(a,o),c=i.values.length,u=i.values.map(e=>ek(e,i.min,i.max)),m=c>1?Math.min(...u):0,p=100-Math.max(...u);return(0,t.jsx)(ea.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...n,ref:d,style:{...e.style,[l.startEdge]:m+"%",[l.endEdge]:p+"%"}})});eS.displayName=eN;var eC="SliderThumb",eR=r.forwardRef((e,a)=>{let s=ed(e.__scopeSlider),[n,i]=r.useState(null),l=(0,b.useComposedRefs)(a,e=>i(e)),o=r.useMemo(()=>n?s().findIndex(e=>e.ref.current===n):-1,[s,n]);return(0,t.jsx)(eD,{...e,ref:l,index:o})}),eD=r.forwardRef((e,a)=>{var s,n,i,l,o;let d,c,{__scopeSlider:u,index:m,name:p,...x}=e,f=ex(eC,u),h=ev(eC,u),[v,g]=r.useState(null),j=(0,b.useComposedRefs)(a,e=>g(e)),w=!v||f.form||!!v.closest("form"),N=(0,D.useSize)(v),S=f.values[m],C=void 0===S?0:ek(S,f.min,f.max),R=(s=m,(n=f.values.length)>2?`Value ${s+1} of ${n}`:2===n?["Minimum","Maximum"][s]:void 0),P=N?.[h.size],k=P?(i=P,l=C,o=h.direction,c=eI([0,50],[0,d=i/2]),(d-c(l)*o)*o):0;return r.useEffect(()=>{if(v)return f.thumbs.add(v),()=>{f.thumbs.delete(v)}},[v,f.thumbs]),(0,t.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[h.startEdge]:`calc(${C}% + ${k}px)`},children:[(0,t.jsx)(eo.ItemSlot,{scope:e.__scopeSlider,children:(0,t.jsx)(ea.span,{role:"slider","aria-label":e["aria-label"]||R,"aria-valuemin":f.min,"aria-valuenow":S,"aria-valuemax":f.max,"aria-orientation":f.orientation,"data-orientation":f.orientation,"data-disabled":f.disabled?"":void 0,tabIndex:f.disabled?void 0:0,...x,ref:j,style:void 0===S?{display:"none"}:e.style,onFocus:(0,y.composeEventHandlers)(e.onFocus,()=>{f.valueIndexToChangeRef.current=m})})}),w&&(0,t.jsx)(eP,{name:p??(f.name?f.name+(f.values.length>1?"[]":""):void 0),form:f.form,value:S},m)]})});eR.displayName=eC;var eP=r.forwardRef(({__scopeSlider:e,value:a,...s},n)=>{let i=r.useRef(null),l=(0,b.useComposedRefs)(i,n),o=(0,P.usePrevious)(a);return r.useEffect(()=>{let e=i.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(o!==a&&t){let r=new Event("input",{bubbles:!0});t.call(e,a),e.dispatchEvent(r)}},[o,a]),(0,t.jsx)(ea.input,{style:{display:"none"},...s,ref:l,defaultValue:a})});function ek(e,t,a){return(0,et.clamp)(100/(a-t)*(e-t),[0,100])}function eI(e,t){return a=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(a-e[0])}}eP.displayName="RadioBubbleInput",e.s(["Range",()=>eS,"Root",()=>ef,"Slider",()=>ef,"SliderRange",()=>eS,"SliderThumb",()=>eR,"SliderTrack",()=>ew,"Thumb",()=>eR,"Track",()=>ew,"createSliderScope",()=>em],86976);var eA=e.i(86976),eA=eA;function eE({className:e,defaultValue:a,value:s,min:n=0,max:i=100,...l}){let o=r.useMemo(()=>Array.isArray(s)?s:Array.isArray(a)?a:[n,i],[s,a,n,i]);return(0,t.jsxs)(eA.Root,{"data-slot":"slider",defaultValue:a,value:s,min:n,max:i,className:(0,h.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...l,children:[(0,t.jsx)(eA.Track,{"data-slot":"slider-track",className:(0,h.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,t.jsx)(eA.Range,{"data-slot":"slider-range",className:(0,h.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:o.length},(e,a)=>(0,t.jsx)(eA.Thumb,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},a))]})}var eT=e.i(41868),eM=e.i(69501),eL=e.i(94325);let eV=(0,eL.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ez=[{value:"destroyed",label:"Destroyed",description:"Structure completely destroyed"},{value:"major",label:"Major",description:"Significant structural damage"},{value:"minor",label:"Minor",description:"Cosmetic or limited damage"},{value:"affected",label:"Affected",description:"In affected area, minor impact"},{value:"none",label:"None",description:"No damage observed"}];function eH({open:e,onOpenChange:a,incidentId:n,parcel:i}){let[l,o]=(0,r.useState)("minor"),[d,m]=(0,r.useState)([25]),[p,x]=(0,r.useState)([10]),[f,h]=(0,r.useState)(new Date().toISOString().split("T")[0]),[j,y]=(0,r.useState)(""),b=(0,s.useSubmitSurvey)(),w=async()=>{try{await b.mutateAsync({incidentId:n,parcelId:i.affectedParcelId,survey:{damageLevel:l,improvementDamagePercent:d[0],landDamagePercent:p[0],surveyDate:f,notes:j}}),eM.toast.success("Damage survey submitted",{description:`Survey recorded for parcel ${i.apn}`}),a(!1)}catch(e){eM.toast.error("Failed to submit survey",{description:"Please try again"})}};return(0,t.jsx)(c.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(c.DialogContent,{className:"sm:max-w-lg",children:[(0,t.jsxs)(c.DialogHeader,{children:[(0,t.jsx)(c.DialogTitle,{children:"Damage Survey"}),(0,t.jsxs)(c.DialogDescription,{children:["Record damage assessment for parcel"," ",(0,t.jsx)("span",{className:"font-mono font-medium",children:i.apn})]})]}),(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(v,{className:"text-sm font-medium",children:"Damage Level"}),(0,t.jsx)(Z,{value:l,onValueChange:o,children:ez.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 rounded-lg border p-3 cursor-pointer hover:bg-muted/50 transition-colors",children:[(0,t.jsx)(ee,{value:e.value,id:e.value}),(0,t.jsxs)(v,{htmlFor:e.value,className:"flex-1 cursor-pointer",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.label}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.value))})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(v,{className:"text-sm font-medium",children:"Improvement Damage"}),(0,t.jsxs)("span",{className:"text-sm font-medium tabular-nums",children:[d[0],"%"]})]}),(0,t.jsx)(eE,{value:d,onValueChange:m,min:0,max:100,step:5,className:"w-full"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(v,{className:"text-sm font-medium",children:"Land Damage"}),(0,t.jsxs)("span",{className:"text-sm font-medium tabular-nums",children:[p[0],"%"]})]}),(0,t.jsx)(eE,{value:p,onValueChange:x,min:0,max:100,step:5,className:"w-full"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{className:"text-sm font-medium",children:"Survey Date"}),(0,t.jsx)(eT.Input,{type:"date",value:f,onChange:e=>h(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v,{className:"text-sm font-medium",children:"Notes"}),(0,t.jsx)(g,{value:j,onChange:e=>y(e.target.value),placeholder:"Additional observations...",rows:3})]})]}),(0,t.jsxs)(c.DialogFooter,{children:[(0,t.jsx)(u.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,t.jsxs)(u.Button,{onClick:w,disabled:b.isPending,children:[b.isPending&&(0,t.jsx)(eV,{className:"h-4 w-4 mr-2 animate-spin"}),"Submit Survey"]})]})]})})}var eB=e.i(48846),eK=e.i(56688),e_=e.i(36941);function eO({open:e,onOpenChange:a,incidentId:n,parcel:i}){let[l,o]=(0,r.useState)(null),d=(0,s.useComputeReassessment)(),m=async()=>{try{let e=await d.mutateAsync({incidentId:n,parcelId:i.affectedParcelId});o(e),eM.toast.success("Reassessment computed",{description:`Value reduction of ${(0,eB.formatCurrency)(e.reductionAmount)} for parcel ${i.apn}`})}catch(e){eM.toast.error("Failed to compute reassessment",{description:"Please try again"})}};return(0,t.jsx)(c.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(c.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(c.DialogHeader,{children:[(0,t.jsx)(c.DialogTitle,{children:"Reassessment"}),(0,t.jsxs)(c.DialogDescription,{children:["Compute revised values for parcel"," ",(0,t.jsx)("span",{className:"font-mono font-medium",children:i.apn})]})]}),l?(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-success",children:[(0,t.jsx)(e_.CheckCircle,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Reassessment Complete"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Prior Value"}),(0,t.jsx)("p",{className:"text-sm font-semibold tabular-nums",children:(0,eB.formatCurrency)(l.priorTotalValue)})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Revised Value"}),(0,t.jsx)("p",{className:"text-sm font-semibold tabular-nums text-primary",children:(0,eB.formatCurrency)(l.revisedTotalValue)})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Reduction"}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,t.jsx)(eK.TrendingDown,{className:"h-3.5 w-3.5 text-destructive"}),(0,t.jsx)("p",{className:"text-sm font-semibold tabular-nums text-destructive",children:(0,eB.formatCurrency)(l.reductionAmount)})]})]})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-3 space-y-2 text-xs",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Land"}),(0,t.jsxs)("span",{children:[(0,eB.formatCurrency)(l.priorLandValue)," → ",(0,eB.formatCurrency)(l.revisedLandValue)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Improvements"}),(0,t.jsxs)("span",{children:[(0,eB.formatCurrency)(l.priorImprovementValue)," → ",(0,eB.formatCurrency)(l.revisedImprovementValue)]})]})]})]}):(0,t.jsx)("div",{className:"py-6 text-center",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"This will compute revised property values based on the recorded damage survey data. The computation uses standard calamity reassessment formulas."})}),(0,t.jsx)(c.DialogFooter,{children:l?(0,t.jsx)(u.Button,{onClick:()=>a(!1),children:"Done"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,t.jsxs)(u.Button,{onClick:m,disabled:d.isPending,children:[d.isPending&&(0,t.jsx)(eV,{className:"h-4 w-4 mr-2 animate-spin"}),"Compute Reassessment"]})]})})]})})}var e$=e.i(31906),eF=e.i(93749),eG=e.i(79001),eU=e.i(71908),eq=e.i(31404),eX=e.i(50875),eY=e.i(43970),eJ=e.i(83685),eQ=e.i(75482);let eW=(0,eL.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var eZ=e.i(69833),e0=e.i(1057),e1=e.i(33217);function e3(){let e=(0,a.useParams)().id,{data:c,isLoading:m,error:p}=(0,s.useIncident)(e),[x,f]=(0,r.useState)(1),[h,v]=(0,r.useState)("all"),[g,j]=(0,r.useState)(null),[y,b]=(0,r.useState)(null),{data:w,isLoading:N}=(0,s.useAffectedParcels)({incidentId:e,page:x,damageLevel:"all"!==h?h:void 0});if(m)return(0,t.jsx)(eF.DetailSkeleton,{});if(p||!c)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(eJ.AlertCircle,{className:"h-8 w-8 text-destructive mb-4"}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Incident not found"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"The requested incident could not be loaded."})]});let S=[{accessorKey:"apn",header:"APN",cell:({row:e})=>(0,t.jsx)(e1.default,{href:`/parcels/${e.original.parcelId}`,className:"font-mono text-sm font-medium text-primary hover:underline",children:e.getValue("apn")})},{accessorKey:"primaryAddress",header:"Address",cell:({row:e})=>(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e.getValue("primaryAddress")||"—"})},{accessorKey:"damageLevel",header:"Damage",cell:({row:e})=>{let a=e.getValue("damageLevel");return a?(0,t.jsx)(i.DamageBadge,{level:a}):(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"—"})}},{accessorKey:"surveyStatus",header:"Survey",cell:({row:e})=>(0,t.jsx)(eU.Badge,{variant:"outline",className:"text-xs capitalize",children:e.getValue("surveyStatus")?.replace(/_/g," ")||"pending"})},{accessorKey:"reassessmentStatus",header:"Reassessment",cell:({row:e})=>(0,t.jsx)(eU.Badge,{variant:"outline",className:"text-xs capitalize",children:e.getValue("reassessmentStatus")?.replace(/_/g," ")||"pending"})},{id:"actions",header:"Actions",cell:({row:e})=>{let a=e.original;return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)(u.Button,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:e=>{e.stopPropagation(),j(a)},children:[(0,t.jsx)(eZ.FileSearch,{className:"h-3.5 w-3.5 mr-1"}),"Survey"]}),(0,t.jsxs)(u.Button,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:e=>{e.stopPropagation(),b(a)},children:[(0,t.jsx)(e0.Calculator,{className:"h-3.5 w-3.5 mr-1"}),"Reassess"]})]})}}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(e1.default,{href:"/calamity",children:(0,t.jsxs)(u.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground -ml-2",children:[(0,t.jsx)(eY.ArrowLeft,{className:"h-4 w-4 mr-1"}),"Calamity"]})}),(0,t.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(d.IncidentTypeIcon,{type:c.incidentType,size:"lg"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:c.name}),(0,t.jsx)(n.StatusBadge,{status:c.status})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:eX.incidentTypeLabels[c.incidentType]||c.incidentType})]})]})}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsx)(eG.Card,{className:"shadow-sm",children:(0,t.jsxs)(eG.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)(eW,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start Date"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:(0,eB.formatDate)(c.startDate)})]})]})}),(0,t.jsx)(eG.Card,{className:"shadow-sm",children:(0,t.jsxs)(eG.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)(eW,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"End Date"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:c.endDate?(0,eB.formatDate)(c.endDate):"Ongoing"})]})]})}),(0,t.jsx)(eG.Card,{className:"shadow-sm",children:(0,t.jsxs)(eG.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)(eQ.MapPin,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Affected Parcels"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:c.affectedParcelCount||0})]})]})})]}),c.description&&(0,t.jsx)(eG.Card,{className:"shadow-sm",children:(0,t.jsx)(eG.CardContent,{className:"p-4",children:(0,t.jsx)("p",{className:"text-sm",children:c.description})})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Affected Parcels"}),(0,t.jsxs)(eq.Select,{value:h,onValueChange:e=>{v(e),f(1)},children:[(0,t.jsx)(eq.SelectTrigger,{className:"h-9 w-[160px]",children:(0,t.jsx)(eq.SelectValue,{placeholder:"Damage Level"})}),(0,t.jsxs)(eq.SelectContent,{children:[(0,t.jsx)(eq.SelectItem,{value:"all",children:"All Levels"}),(0,t.jsx)(eq.SelectItem,{value:"destroyed",children:"Destroyed"}),(0,t.jsx)(eq.SelectItem,{value:"major",children:"Major"}),(0,t.jsx)(eq.SelectItem,{value:"minor",children:"Minor"}),(0,t.jsx)(eq.SelectItem,{value:"affected",children:"Affected"}),(0,t.jsx)(eq.SelectItem,{value:"none",children:"None"})]})]})]}),(0,t.jsx)(l.DataTable,{columns:S,data:w?.data||[],isLoading:N,emptyState:(0,t.jsx)(e$.EmptyState,{icon:eQ.MapPin,title:"No affected parcels",description:"No parcels have been linked to this incident yet."})}),w?.pagination&&(0,t.jsx)(o.DataTablePagination,{pagination:w.pagination,onPageChange:f})]}),g&&(0,t.jsx)(eH,{open:!!g,onOpenChange:e=>!e&&j(null),incidentId:e,parcel:g}),y&&(0,t.jsx)(eO,{open:!!y,onOpenChange:e=>!e&&b(null),incidentId:e,parcel:y})]})}e.s(["default",()=>e3],45003)}]);