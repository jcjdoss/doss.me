(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69348,t=>{"use strict";var e=t.i(59834);function a({title:t,description:a,actions:i}){return(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:t}),a&&(0,e.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a})]}),i&&(0,e.jsx)("div",{className:"flex items-center gap-2",children:i})]})}t.s(["PageHeader",()=>a])},81368,t=>{"use strict";var e=t.i(59834),a=t.i(79448),i=t.i(42656),s=t.i(50752),r=t.i(83113),n=t.i(7101),o=t.i(81837);t.i(37673);var l=t.i(79542),c=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((t,a)=>{let s=(0,l.createSlot)(`Primitive.${a}`),r=i.forwardRef((t,i)=>{let{asChild:r,...n}=t;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,e.jsx)(r?s:a,{...n,ref:i})});return r.displayName=`Primitive.${a}`,{...t,[a]:r}},{}),d=t.i(58853),u=t.i(87910),h=t.i(94173),m="Tabs",[p,f]=(0,r.createContextScope)(m,[n.createRovingFocusGroupScope]),g=(0,n.createRovingFocusGroupScope)(),[v,x]=p(m),b=i.forwardRef((t,a)=>{let{__scopeTabs:i,value:s,onValueChange:r,defaultValue:n,orientation:o="horizontal",dir:l,activationMode:p="automatic",...f}=t,g=(0,d.useDirection)(l),[x,b]=(0,u.useControllableState)({prop:s,onChange:r,defaultProp:n??"",caller:m});return(0,e.jsx)(v,{scope:i,baseId:(0,h.useId)(),value:x,onValueChange:b,orientation:o,dir:g,activationMode:p,children:(0,e.jsx)(c.div,{dir:g,"data-orientation":o,...f,ref:a})})});b.displayName=m;var y="TabsList",j=i.forwardRef((t,a)=>{let{__scopeTabs:i,loop:s=!0,...r}=t,o=x(y,i),l=g(i);return(0,e.jsx)(n.Root,{asChild:!0,...l,orientation:o.orientation,dir:o.dir,loop:s,children:(0,e.jsx)(c.div,{role:"tablist","aria-orientation":o.orientation,...r,ref:a})})});j.displayName=y;var N="TabsTrigger",C=i.forwardRef((t,a)=>{let{__scopeTabs:i,value:r,disabled:o=!1,...l}=t,d=x(N,i),u=g(i),h=S(d.baseId,r),m=M(d.baseId,r),p=r===d.value;return(0,e.jsx)(n.Item,{asChild:!0,...u,focusable:!o,active:p,children:(0,e.jsx)(c.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":m,"data-state":p?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:h,...l,ref:a,onMouseDown:(0,s.composeEventHandlers)(t.onMouseDown,t=>{o||0!==t.button||!1!==t.ctrlKey?t.preventDefault():d.onValueChange(r)}),onKeyDown:(0,s.composeEventHandlers)(t.onKeyDown,t=>{[" ","Enter"].includes(t.key)&&d.onValueChange(r)}),onFocus:(0,s.composeEventHandlers)(t.onFocus,()=>{let t="manual"!==d.activationMode;p||o||!t||d.onValueChange(r)})})})});C.displayName=N;var T="TabsContent",w=i.forwardRef((t,a)=>{let{__scopeTabs:s,value:r,forceMount:n,children:l,...d}=t,u=x(T,s),h=S(u.baseId,r),m=M(u.baseId,r),p=r===u.value,f=i.useRef(p);return i.useEffect(()=>{let t=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(t)},[]),(0,e.jsx)(o.Presence,{present:n||p,children:({present:i})=>(0,e.jsx)(c.div,{"data-state":p?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":h,hidden:!i,id:m,tabIndex:0,...d,ref:a,style:{...t.style,animationDuration:f.current?"0s":void 0},children:i&&l})})});function S(t,e){return`${t}-trigger-${e}`}function M(t,e){return`${t}-content-${e}`}w.displayName=T,t.s(["Content",()=>w,"List",()=>j,"Root",()=>b,"Tabs",()=>b,"TabsContent",()=>w,"TabsList",()=>j,"TabsTrigger",()=>C,"Trigger",()=>C,"createTabsScope",()=>f],933);var R=t.i(933),R=R,K=t.i(22513);function k({className:t,orientation:a="horizontal",...i}){return(0,e.jsx)(R.Root,{"data-slot":"tabs","data-orientation":a,orientation:a,className:(0,K.cn)("group/tabs flex gap-2 data-[orientation=horizontal]:flex-col",t),...i})}let O=(0,a.cva)("rounded-lg p-[3px] group-data-[orientation=horizontal]/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-[orientation=vertical]/tabs:h-fit group-data-[orientation=vertical]/tabs:flex-col",{variants:{variant:{default:"bg-muted",line:"gap-1 bg-transparent"}},defaultVariants:{variant:"default"}});function P({className:t,variant:a="default",...i}){return(0,e.jsx)(R.List,{"data-slot":"tabs-list","data-variant":a,className:(0,K.cn)(O({variant:a}),t),...i})}function F({className:t,...a}){return(0,e.jsx)(R.Trigger,{"data-slot":"tabs-trigger",className:(0,K.cn)("focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all group-data-[orientation=vertical]/tabs:w-full group-data-[orientation=vertical]/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 group-data-[variant=default]/tabs-list:data-[state=active]:shadow-sm group-data-[variant=line]/tabs-list:data-[state=active]:shadow-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:border-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent","data-[state=active]:bg-background dark:data-[state=active]:text-foreground dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 data-[state=active]:text-foreground","after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-[orientation=horizontal]/tabs:after:inset-x-0 group-data-[orientation=horizontal]/tabs:after:bottom-[-5px] group-data-[orientation=horizontal]/tabs:after:h-0.5 group-data-[orientation=vertical]/tabs:after:inset-y-0 group-data-[orientation=vertical]/tabs:after:-right-1 group-data-[orientation=vertical]/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-[state=active]:after:opacity-100",t),...a})}function I({className:t,...a}){return(0,e.jsx)(R.Content,{"data-slot":"tabs-content",className:(0,K.cn)("flex-1 outline-none",t),...a})}t.s(["Tabs",()=>k,"TabsContent",()=>I,"TabsList",()=>P,"TabsTrigger",()=>F],81368)},12061,69833,t=>{"use strict";var e=t.i(42828),a=t.i(42656),i=t.i(93312),s=t.i(77456),r=t.i(54368),n=t.i(12674),o=class extends r.Subscribable{#t;#e=void 0;#a;#i;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,n.shallowEqualObjects)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#a,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,n.hashKey)(e.mutationKey)!==(0,n.hashKey)(this.options.mutationKey)?this.reset():this.#a?.state.status==="pending"&&this.#a.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#a?.removeObserver(this)}onMutationUpdate(t){this.#s(),this.#r(t)}getCurrentResult(){return this.#e}reset(){this.#a?.removeObserver(this),this.#a=void 0,this.#s(),this.#r()}mutate(t,e){return this.#i=e,this.#a?.removeObserver(this),this.#a=this.#t.getMutationCache().build(this.#t,this.options),this.#a.addObserver(this),this.#a.execute(t)}#s(){let t=this.#a?.state??(0,i.getDefaultState)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#r(t){s.notifyManager.batch(()=>{if(this.#i&&this.hasListeners()){let e=this.#e.variables,a=this.#e.context,i={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#i.onSuccess?.(t.data,e,a,i)}catch(t){Promise.reject(t)}try{this.#i.onSettled?.(t.data,null,e,a,i)}catch(t){Promise.reject(t)}}else if(t?.type==="error"){try{this.#i.onError?.(t.error,e,a,i)}catch(t){Promise.reject(t)}try{this.#i.onSettled?.(void 0,t.error,e,a,i)}catch(t){Promise.reject(t)}}}this.listeners.forEach(t=>{t(this.#e)})})}},l=t.i(73252);function c(t,e){let i=(0,l.useQueryClient)(e),[r]=a.useState(()=>new o(i,t));a.useEffect(()=>{r.setOptions(t)},[r,t]);let c=a.useSyncExternalStore(a.useCallback(t=>r.subscribe(s.notifyManager.batchCalls(t)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),d=a.useCallback((t,e)=>{r.mutate(t,e).catch(n.noop)},[r]);if(c.error&&(0,n.shouldThrowError)(r.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:d,mutateAsync:c.mutate}}var d=t.i(85398);function u(t){return(0,e.useQuery)({queryKey:["incidents",t],queryFn:()=>(0,d.apiFetch)("/v1/calamity/incidents",{params:{status:t}})})}function h(t){return(0,e.useQuery)({queryKey:["incident",t],queryFn:()=>(0,d.apiFetch)(`/v1/calamity/incidents/${t}`),enabled:!!t})}function m(t){return(0,e.useQuery)({queryKey:["affected-parcels",t],queryFn:()=>(0,d.apiFetch)(`/v1/calamity/incidents/${t.incidentId}/parcels`,{params:{page:t.page||1,pageSize:t.pageSize||20,damageLevel:t.damageLevel}}),enabled:!!t.incidentId})}function p(){let t=(0,l.useQueryClient)();return c({mutationFn:({incidentId:t,parcelId:e,survey:a})=>(0,d.apiFetch)(`/v1/calamity/incidents/${t}/parcels/${e}/survey`,{method:"POST",body:a}),onSuccess:(e,a)=>{t.invalidateQueries({queryKey:["affected-parcels"]}),t.invalidateQueries({queryKey:["incident",a.incidentId]})}})}function f(){let t=(0,l.useQueryClient)();return c({mutationFn:({incidentId:t,parcelId:e})=>(0,d.apiFetch)(`/v1/calamity/incidents/${t}/parcels/${e}/reassess`,{method:"POST"}),onSuccess:()=>{t.invalidateQueries({queryKey:["affected-parcels"]})}})}t.s(["useAffectedParcels",()=>m,"useComputeReassessment",()=>f,"useIncident",()=>h,"useIncidents",()=>u,"useSubmitSurvey",()=>p],12061);let g=(0,t.i(94325).default)("file-search",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]]);t.s(["FileSearch",()=>g],69833)},84707,t=>{"use strict";var e=t.i(59834),a=t.i(79001),i=t.i(80612),s=t.i(22513);function r({title:t,value:r,icon:n,description:o,trend:l,isLoading:c=!1,className:d}){return(0,e.jsx)(a.Card,{className:(0,s.cn)("shadow-sm",d),children:(0,e.jsxs)(a.CardContent,{className:"p-6",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[n&&(0,e.jsx)(n,{className:"h-4 w-4"}),t]}),(0,e.jsxs)("div",{className:"mt-3 flex items-baseline gap-2",children:[c?(0,e.jsx)(i.Skeleton,{className:"h-8 w-24"}):(0,e.jsx)("span",{className:"text-2xl font-bold tracking-tight",children:r}),l&&!c&&(0,e.jsxs)("span",{className:(0,s.cn)("text-xs font-medium",l.isPositive?"text-success":"text-destructive"),children:[l.isPositive?"+":"",l.value,"%"]})]}),o&&(0,e.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:o})]})})}t.s(["KpiCard",()=>r])},95693,t=>{"use strict";var e=t.i(59834),a=t.i(42656),i=t.i(12061),s=t.i(69348),r=t.i(84707),n=t.i(79001),o=t.i(17896),l=t.i(25933),c=t.i(48846),d=t.i(50875),u=t.i(75482),h=t.i(33217);function m({incident:t}){return(0,e.jsx)(h.default,{href:`/calamity/incidents/${t.incidentId}`,children:(0,e.jsxs)(n.Card,{className:"shadow-sm hover:shadow-md transition-shadow cursor-pointer group h-full",children:[(0,e.jsx)(n.CardHeader,{className:"pb-2",children:(0,e.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2.5 min-w-0",children:[(0,e.jsx)(l.IncidentTypeIcon,{type:t.incidentType,className:"shrink-0"}),(0,e.jsxs)("div",{className:"min-w-0",children:[(0,e.jsx)("h3",{className:"text-sm font-semibold truncate group-hover:text-primary transition-colors",children:t.name}),(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:d.incidentTypeLabels[t.incidentType]||t.incidentType})]})]}),(0,e.jsx)(o.StatusBadge,{status:t.status})]})}),(0,e.jsxs)(n.CardContent,{className:"pt-0",children:[t.description&&(0,e.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-3",children:t.description}),(0,e.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,e.jsxs)("span",{children:["Started ",(0,c.formatDate)(t.startDate)]}),(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsx)(u.MapPin,{className:"h-3 w-3"}),(0,e.jsxs)("span",{className:"font-medium",children:[t.affectedParcelCount||0," parcels"]})]})]})]})]})})}var p=t.i(31906),f=t.i(93749),g=t.i(81368),v=t.i(46472),x=t.i(74182),b=t.i(69833),y=t.i(36941);function j(){let{data:t,isLoading:n}=(0,i.useIncidents)(),[o,l]=(0,a.useState)("all"),d=t?.filter(t=>"active"===t.status).length||0,u=t?.filter(t=>"monitoring"===t.status).length||0,h=t?.filter(t=>"closed"===t.status).length||0,j=t?.reduce((t,e)=>t+(e.affectedParcelCount||0),0)||0,N="all"===o?t||[]:(t||[]).filter(t=>t.status===o);return(0,e.jsxs)("div",{className:"space-y-8",children:[(0,e.jsx)(s.PageHeader,{title:"Calamity",description:"Disaster incidents and property damage assessments"}),(0,e.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,e.jsx)(r.KpiCard,{title:"Active Incidents",value:(0,c.formatNumber)(d),icon:v.Flame,isLoading:n}),(0,e.jsx)(r.KpiCard,{title:"Affected Parcels",value:(0,c.formatNumber)(j),icon:x.AlertTriangle,isLoading:n}),(0,e.jsx)(r.KpiCard,{title:"Monitoring",value:(0,c.formatNumber)(u),icon:b.FileSearch,isLoading:n}),(0,e.jsx)(r.KpiCard,{title:"Closed",value:(0,c.formatNumber)(h),icon:y.CheckCircle,isLoading:n})]}),(0,e.jsx)("div",{children:(0,e.jsx)(g.Tabs,{value:o,onValueChange:l,children:(0,e.jsxs)(g.TabsList,{children:[(0,e.jsxs)(g.TabsTrigger,{value:"all",className:"text-xs",children:["All (",t?.length||0,")"]}),(0,e.jsxs)(g.TabsTrigger,{value:"active",className:"text-xs",children:["Active (",d,")"]}),(0,e.jsxs)(g.TabsTrigger,{value:"monitoring",className:"text-xs",children:["Monitoring (",u,")"]}),(0,e.jsxs)(g.TabsTrigger,{value:"closed",className:"text-xs",children:["Closed (",h,")"]})]})})}),n?(0,e.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(t=>(0,e.jsx)(f.CardSkeleton,{},t))}):0===N.length?(0,e.jsx)(p.EmptyState,{icon:v.Flame,title:"No incidents found",description:"all"!==o?"No incidents with this status":"No calamity incidents have been recorded yet"}):(0,e.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))"},children:N.map(t=>(0,e.jsx)(m,{incident:t},t.incidentId))})]})}t.s(["default",()=>j],95693)}]);