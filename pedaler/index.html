<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDeLR Intelligence Dashboard - Live ADHD Command Center</title>
    <style>
        :root {
            --bg: #f4f4f4;
            --white: #ffffff;
            --dark: #1d2d35;
            --lime: rgb(198, 255, 0);
            --coral: #ff6b6b;
            --blue: #4ecdc4;
            --amber: #ffa726;
            --violet: #ab47bc;
            --font-serif: Georgia, serif;
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-sans);
            background: var(--bg);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .title {
            font-family: var(--font-serif);
            font-size: 3rem;
            font-weight: bold;
            font-style: italic;
            color: var(--dark);
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 20px;
        }
        
        .marker-label {
            display: inline-block;
            background: var(--lime);
            padding: 8px 16px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transform: rotate(-1deg);
            margin: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .status-card {
            background: var(--white);
            padding: 30px 20px;
            border-left: 4px solid var(--lime);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .status-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .status-value.energy { color: var(--coral); }
        .status-value.focus { color: var(--blue); }
        .status-value.load { color: var(--amber); }
        .status-value.ideas { color: var(--violet); }
        
        .status-label {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #666;
            margin-bottom: 10px;
        }
        
        .status-desc {
            font-size: 0.85rem;
            color: #888;
        }
        
        .section {
            background: var(--white);
            margin-bottom: 30px;
            padding: 30px;
            border-left: 4px solid var(--lime);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .section-title {
            font-family: var(--font-serif);
            font-size: 1.8rem;
            font-weight: bold;
            font-style: italic;
            margin-bottom: 20px;
            color: var(--dark);
        }
        
        .priority-item {
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .priority-item:last-child {
            border-bottom: none;
        }
        
        .priority-content {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .priority-score {
            display: inline-block;
            background: var(--coral);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 10px;
        }
        
        .priority-reason {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .priority-context {
            font-size: 0.85rem;
            color: #888;
            font-style: italic;
        }
        
        .overdue {
            background: #ffebee !important;
            border-left-color: var(--coral) !important;
        }
        
        .overdue .priority-content::before {
            content: "üö® ";
        }
        
        .alert-item {
            background: #fff3e0;
            border: 1px solid var(--amber);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .alert-item::before {
            content: "‚ö†Ô∏è ";
            margin-right: 8px;
        }
        
        .recommendation-item {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .recommendation-item::before {
            content: "üí° ";
            margin-right: 8px;
        }
        
        .pattern-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .pattern-optimal { background: #e8f5e8; color: #2e7d32; }
        .pattern-maintenance { background: #fff3e0; color: #ef6c00; }
        .pattern-distraction { background: #ffebee; color: #c62828; }
        .pattern-steady { background: #e3f2fd; color: #1565c0; }
        
        .last-updated {
            text-align: center;
            font-size: 0.85rem;
            color: #888;
            margin-top: 20px;
        }
        
        .refresh-btn {
            background: var(--lime);
            border: none;
            padding: 12px 24px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            cursor: pointer;
            transform: rotate(-1deg);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px auto;
            display: block;
        }
        
        .refresh-btn:hover {
            background: rgb(178, 230, 0);
            transform: rotate(0deg);
        }
        
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        @media (max-width: 600px) {
            .title { font-size: 2rem; }
            .status-grid { grid-template-columns: repeat(2, 1fr); }
            .section { padding: 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">PDeLR Intelligence Dashboard</h1>
            <p class="subtitle">AI-Powered ADHD Executive Function Command Center</p>
            <div class="marker-label">Live Real-Time Data</div>
        </div>
        
        <div class="status-grid" id="statusGrid">
            <div class="status-card">
                <div class="status-value energy" id="energyValue">-</div>
                <div class="status-label">Cognitive Energy</div>
                <div class="status-desc" id="energyDesc">Loading...</div>
            </div>
            <div class="status-card">
                <div class="status-value focus" id="focusValue">-</div>
                <div class="status-label">Executive Function</div>
                <div class="status-desc" id="focusDesc">Loading...</div>
            </div>
            <div class="status-card">
                <div class="status-value load" id="loadValue">-</div>
                <div class="status-label">Mental Bandwidth</div>
                <div class="status-desc" id="loadDesc">Loading...</div>
            </div>
            <div class="status-card">
                <div class="status-value ideas" id="ideasValue">-</div>
                <div class="status-label">Distraction Signals</div>
                <div class="status-desc" id="ideasDesc">Loading...</div>
            </div>
        </div>
        
        <div class="section" id="theOneThingSection">
            <h2 class="section-title">üéØ The ONE Thing</h2>
            <div id="theOneThingContent">Loading...</div>
        </div>
        
        <div class="section" id="todaySection">
            <h2 class="section-title">üìÖ TODAY (Must Do)</h2>
            <div id="todayContent">Loading priorities...</div>
        </div>
        
        <div class="section" id="weekSection">
            <h2 class="section-title">üìÜ THIS WEEK (Important)</h2>
            <div id="weekContent">Loading priorities...</div>
        </div>
        
        <div class="section" id="alertsSection" style="display: none;">
            <h2 class="section-title">üö® ALERTS</h2>
            <div id="alertsContent"></div>
        </div>
        
        <div class="section" id="recommendationsSection" style="display: none;">
            <h2 class="section-title">üí° RECOMMENDATIONS</h2>
            <div id="recommendationsContent"></div>
        </div>
        
        <div class="section" id="patternsSection">
            <h2 class="section-title">üß† Live Pattern Analysis</h2>
            <div id="patternsContent">Loading analysis...</div>
        </div>
        
        <button class="refresh-btn" id="refreshBtn" onclick="refreshDashboard()">
            Refresh Intelligence
        </button>
        
        <div class="last-updated" id="lastUpdated">
            Last updated: Loading...
        </div>
    </div>
    
    <script>
        let isLoading = false;
        
        async function loadDashboard() {
            if (isLoading) return;
            
            isLoading = true;
            document.body.classList.add('loading');
            
            try {
                const response = await fetch('./data.json');
                if (!response.ok) throw new Error('Failed to load dashboard data');
                
                const data = await response.json();
                updateDashboard(data);
            } catch (error) {
                console.error('Dashboard load error:', error);
                showError('Failed to load dashboard data. Check console for details.');
            } finally {
                isLoading = false;
                document.body.classList.remove('loading');
            }
        }
        
        function updateDashboard(data) {
            // Update status cards
            document.getElementById('energyValue').textContent = data.status.energy;
            document.getElementById('focusValue').textContent = data.status.focus;
            document.getElementById('loadValue').textContent = data.status.cognitiveLoad + '%';
            document.getElementById('ideasValue').textContent = data.status.newIdeas;
            
            // Energy descriptions
            const energyDescs = {
                1: 'Exhausted', 2: 'Very Low', 3: 'Low', 4: 'Below Average',
                5: 'Moderate', 6: 'Good', 7: 'High', 8: 'Very High',
                9: 'Excellent', 10: 'Hyperfocus'
            };
            document.getElementById('energyDesc').textContent = energyDescs[data.status.energy] || 'Unknown';
            document.getElementById('focusDesc').textContent = 'Working memory + cognitive flexibility';
            document.getElementById('loadDesc').textContent = `${100 - data.status.cognitiveLoad}% available capacity`;
            document.getElementById('ideasDesc').textContent = data.status.newIdeas > 3 ? 'High distraction risk' : 'Controlled idea generation';
            
            // The ONE Thing
            const oneThingText = data.status.theOneThing && data.status.theOneThing !== '[MUST BE SET TO PROCEED]' 
                ? data.status.theOneThing 
                : '‚ùå THE ONE THING not set - use PRIORITIES-TODAY.md decision engine';
            document.getElementById('theOneThingContent').innerHTML = `<div style="font-size: 1.1rem; font-weight: 600; color: ${data.status.theOneThing && data.status.theOneThing !== '[MUST BE SET TO PROCEED]' ? 'var(--dark)' : 'var(--coral)'};">${oneThingText}</div>`;
            
            // Today's priorities
            let todayHTML = '';
            data.priorities.today.forEach((task, i) => {
                const itemClass = task.overdue ? 'priority-item overdue' : 'priority-item';
                const overdueText = task.daysOverdue > 0 ? ` [OVERDUE ${task.daysOverdue} days]` : '';
                todayHTML += `
                    <div class="${itemClass}">
                        <div class="priority-content">
                            ${i + 1}. ${task.content}${overdueText}
                            <span class="priority-score">${task.score}</span>
                        </div>
                        <div class="priority-reason">WHY: ${task.reason}</div>
                        ${task.context ? `<div class="priority-context">${task.context}</div>` : ''}
                    </div>
                `;
            });
            document.getElementById('todayContent').innerHTML = todayHTML || '<p>No priority tasks found.</p>';
            
            // Week's priorities
            let weekHTML = '';
            data.priorities.week.forEach((task, i) => {
                weekHTML += `
                    <div class="priority-item">
                        <div class="priority-content">${i + 1}. ${task.content}</div>
                        <div class="priority-reason">WHY: ${task.reason}</div>
                    </div>
                `;
            });
            document.getElementById('weekContent').innerHTML = weekHTML || '<p>No weekly priorities found.</p>';
            
            // Alerts
            if (data.alerts && data.alerts.length > 0) {
                document.getElementById('alertsSection').style.display = 'block';
                let alertsHTML = '';
                data.alerts.forEach(alert => {
                    alertsHTML += `<div class="alert-item">${alert}</div>`;
                });
                document.getElementById('alertsContent').innerHTML = alertsHTML;
            } else {
                document.getElementById('alertsSection').style.display = 'none';
            }
            
            // Recommendations
            if (data.recommendations && data.recommendations.length > 0) {
                document.getElementById('recommendationsSection').style.display = 'block';
                let recHTML = '';
                data.recommendations.forEach(rec => {
                    recHTML += `<div class="recommendation-item">${rec}</div>`;
                });
                document.getElementById('recommendationsContent').innerHTML = recHTML;
            } else {
                document.getElementById('recommendationsSection').style.display = 'none';
            }
            
            // Patterns
            let patternHTML = '';
            if (data.patterns) {
                const stateClasses = {
                    'optimal-execution': 'pattern-optimal',
                    'maintenance-mode': 'pattern-maintenance', 
                    'distraction-risk': 'pattern-distraction',
                    'steady-progress': 'pattern-steady'
                };
                
                const stateLabels = {
                    'optimal-execution': '‚úÖ Optimal Execution State',
                    'maintenance-mode': '‚ö†Ô∏è Maintenance Mode',
                    'distraction-risk': 'üö® Distraction Risk',
                    'steady-progress': 'üéØ Steady Progress'
                };
                
                const stateClass = stateClasses[data.patterns.executionState] || 'pattern-steady';
                const stateLabel = stateLabels[data.patterns.executionState] || data.patterns.executionState;
                
                patternHTML += `<div class="pattern-badge ${stateClass}">${stateLabel}</div><br><br>`;
                
                if (data.patterns.optimizations && data.patterns.optimizations.length > 0) {
                    patternHTML += '<strong>Current Optimization:</strong><br>';
                    data.patterns.optimizations.forEach(opt => {
                        patternHTML += `‚Ä¢ ${opt}<br>`;
                    });
                }
            }
            document.getElementById('patternsContent').innerHTML = patternHTML || 'Pattern analysis in progress...';
            
            // Update timestamp
            const lastUpdated = new Date(data.lastUpdated).toLocaleString();
            document.getElementById('lastUpdated').textContent = `Last updated: ${lastUpdated}`;
        }
        
        function showError(message) {
            document.getElementById('todayContent').innerHTML = `<div style="color: var(--coral); font-weight: 600;">‚ö†Ô∏è ${message}</div>`;
        }
        
        async function refreshDashboard() {
            await loadDashboard();
        }
        
        // Load dashboard on page load
        window.addEventListener('load', loadDashboard);
        
        // Auto-refresh every 5 minutes
        setInterval(loadDashboard, 5 * 60 * 1000);
    </script>
</body>
</html>